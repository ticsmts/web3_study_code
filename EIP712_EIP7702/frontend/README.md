# TokenBank DApp Frontend

ä¸€ä¸ªå±•ç¤ºä¸‰ç§ä¸åŒ ERC20 ä»£å¸å­˜æ¬¾æ–¹å¼çš„å®Œæ•´å‰ç«¯åº”ç”¨ï¼Œä½¿ç”¨ RainbowKit + Wagmi + Viem æ„å»ºã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹æ€§

### ä¸‰ç§å­˜æ¬¾æ–¹å¼å¯¹æ¯”

1. **V1: Approve + Deposit (ä¼ ç»Ÿæ–¹å¼)**
   - æ­¥éª¤ 1: è°ƒç”¨ `token.approve()` æˆæƒ
   - æ­¥éª¤ 2: è°ƒç”¨ `bank.deposit()` å­˜æ¬¾
   - âš ï¸ éœ€è¦ 2 ç¬”é“¾ä¸Šäº¤æ˜“ï¼Œgas è´¹ç”¨è¾ƒé«˜

2. **V2: TransferWithCallback (å›è°ƒæ–¹å¼)**
   - æ­¥éª¤: è°ƒç”¨ `token.transferWithCallback()`
   - âœ¨ åªéœ€ 1 ç¬”äº¤æ˜“
   - âš ï¸ éœ€è¦ä»£å¸åˆçº¦æ”¯æŒå›è°ƒåŠŸèƒ½ï¼ˆå¦‚ ERC777ï¼‰
   - ğŸ“ æ³¨æ„ï¼šå½“å‰ ZZTokenV2 ä¸æ”¯æŒæ­¤åŠŸèƒ½

3. **V3: Permit + PermitDeposit (æ¨èæ–¹å¼)** â­
   - æ­¥éª¤ 1: ç¦»çº¿ç­¾å (EIP-2612 Permit)
   - æ­¥éª¤ 2: è°ƒç”¨ `bank.permitDeposit()`
   - âœ… åªéœ€ 1 ç¬”é“¾ä¸Šäº¤æ˜“
   - âœ… ç”¨æˆ·ä½“éªŒæœ€ä½³
   - âœ… èŠ‚çœ gas è´¹ç”¨

### å…¶ä»–åŠŸèƒ½

- ğŸ’° **Withdraw**: ä¸€é”®å–å‡ºæ‰€æœ‰å­˜æ¬¾
- ğŸ“Š **ä½™é¢æ˜¾ç¤º**: å®æ—¶æ˜¾ç¤ºé’±åŒ…ä½™é¢ã€å­˜æ¬¾ä½™é¢ã€æ€»å­˜æ¬¾
- ğŸ¨ **ç°ä»£åŒ– UI**: ä½¿ç”¨æ¸å˜è‰²ã€ç»ç’ƒæ€æ•ˆæœã€åŠ¨ç”»

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Node.js 18+
- Foundry (ç”¨äºæ™ºèƒ½åˆçº¦ç¼–è¯‘å’Œéƒ¨ç½²)
- MetaMask æˆ–å…¶ä»– Web3 é’±åŒ…

### 1. å®‰è£…ä¾èµ–

```bash
cd frontend
npm install
```

### 2. å¯åŠ¨ Anvil æœ¬åœ°èŠ‚ç‚¹

åœ¨æ–°çš„ç»ˆç«¯çª—å£ä¸­ï¼š

```bash
cd ..
anvil
```

ä¿æŒ Anvil è¿è¡Œã€‚è®°ä¸‹æ˜¾ç¤ºçš„è´¦æˆ·åœ°å€å’Œç§é’¥ã€‚

### 3. éƒ¨ç½²æ™ºèƒ½åˆçº¦

åœ¨å¦ä¸€ä¸ªç»ˆç«¯çª—å£ä¸­ï¼š

```bash
# ç¼–è¯‘åˆçº¦
forge build

# éƒ¨ç½²åˆ°æœ¬åœ°ç½‘ç»œ
forge script script/Deploy.s.sol --rpc-url http://localhost:8545 --broadcast
```

éƒ¨ç½²æˆåŠŸåï¼Œä½ ä¼šçœ‹åˆ°ç±»ä¼¼çš„è¾“å‡ºï¼š

```
=== Deployment Summary ===
Network: Local Anvil
Deployer: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
ZZTokenV2: 0x5FbDB2315678afecb367f032d93F642f64180aa3
TokenBankV3: 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512
```

### 4. æ›´æ–°åˆçº¦åœ°å€

æ‰“å¼€ `frontend/config/contracts.ts`ï¼Œæ›´æ–°åˆçº¦åœ°å€ä¸ºéƒ¨ç½²åçš„å®é™…åœ°å€ï¼š

```typescript
export const CONTRACTS = {
  TOKEN_ADDRESS: '0x5FbDB2315678afecb367f032d93F642f64180aa3', // æ›´æ–°ä¸ºå®é™…åœ°å€
  BANK_ADDRESS: '0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512',  // æ›´æ–°ä¸ºå®é™…åœ°å€
} as const;
```

### 5. é…ç½® MetaMask

1. æ·»åŠ æœ¬åœ°ç½‘ç»œï¼š
   - ç½‘ç»œåç§°: Anvil Local
   - RPC URL: http://127.0.0.1:8545
   - Chain ID: 31337
   - è´§å¸ç¬¦å·: ETH

2. å¯¼å…¥æµ‹è¯•è´¦æˆ·ï¼š
   - ä½¿ç”¨ Anvil æ˜¾ç¤ºçš„ç§é’¥å¯¼å…¥è´¦æˆ·
   - æ¨èå¯¼å…¥è´¦æˆ· #0 å’Œ #1

### 6. å¯åŠ¨å‰ç«¯

```bash
cd frontend
npm run dev
```

æ‰“å¼€æµè§ˆå™¨è®¿é—® http://localhost:3000

## ğŸ® ä½¿ç”¨è¯´æ˜

### æµ‹è¯• V1 (Approve + Deposit)

1. è¿æ¥é’±åŒ…
2. åœ¨ V1 å¡ç‰‡ä¸­è¾“å…¥å­˜æ¬¾æ•°é‡ï¼ˆå¦‚ 100ï¼‰
3. ç‚¹å‡» "Step 1: Approve"ï¼Œåœ¨ MetaMask ä¸­ç¡®è®¤äº¤æ˜“
4. ç­‰å¾…äº¤æ˜“ç¡®è®¤åï¼Œç‚¹å‡» "Step 2: Deposit"
5. å†æ¬¡ç¡®è®¤äº¤æ˜“ï¼Œå®Œæˆå­˜æ¬¾

### æµ‹è¯• V3 (Permit + PermitDeposit)

1. åœ¨ V3 å¡ç‰‡ä¸­è¾“å…¥å­˜æ¬¾æ•°é‡ï¼ˆå¦‚ 100ï¼‰
2. ç‚¹å‡» "Sign Permit"ï¼Œåœ¨ MetaMask ä¸­ç­¾åï¼ˆç¦»çº¿ï¼Œä¸æ¶ˆè€— gasï¼‰
3. ç­¾åå®Œæˆåï¼Œç‚¹å‡» "Submit Transaction"
4. ç¡®è®¤äº¤æ˜“ï¼Œä¸€ç¬”äº¤æ˜“å®Œæˆå­˜æ¬¾ï¼

### æµ‹è¯• Withdraw

1. åœ¨ Withdraw éƒ¨åˆ†å¯ä»¥çœ‹åˆ°ä½ çš„å­˜æ¬¾ä½™é¢
2. ç‚¹å‡» "Withdraw All" å–å›æ‰€æœ‰å­˜æ¬¾
3. ç¡®è®¤äº¤æ˜“

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
frontend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ layout.tsx          # æ ¹å¸ƒå±€ + Providers
â”‚   â”œâ”€â”€ page.tsx            # ä¸»é¡µé¢
â”‚   â””â”€â”€ globals.css         # å…¨å±€æ ·å¼
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ Providers.tsx       # RainbowKit + Wagmi é…ç½®
â”‚   â”œâ”€â”€ V1Approve.tsx       # V1 å­˜æ¬¾ç»„ä»¶
â”‚   â”œâ”€â”€ V2Callback.tsx      # V2 å­˜æ¬¾ç»„ä»¶
â”‚   â”œâ”€â”€ V3Permit.tsx        # V3 å­˜æ¬¾ç»„ä»¶
â”‚   â””â”€â”€ WithdrawSection.tsx # å–æ¬¾ç»„ä»¶
â”œâ”€â”€ config/
â”‚   â””â”€â”€ contracts.ts        # åˆçº¦åœ°å€å’Œ ABI
â””â”€â”€ package.json
```

## ğŸ¨ æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Next.js 14 (App Router)
- **è¯­è¨€**: TypeScript
- **æ ·å¼**: TailwindCSS + Custom CSS
- **Web3**: 
  - RainbowKit (é’±åŒ…è¿æ¥)
  - Wagmi (React Hooks)
  - Viem (ä»¥å¤ªåŠäº¤äº’)
- **æ™ºèƒ½åˆçº¦**: Solidity, Foundry

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **V2 åŠŸèƒ½**: å½“å‰ ZZTokenV2 ä½¿ç”¨æ ‡å‡† ERC20ï¼Œä¸æ”¯æŒ transferWithCallbackã€‚æ­¤åŠŸèƒ½ä»…ç”¨äºæ¼”ç¤ºè¯´æ˜ã€‚

2. **é“¾ ID**: ç¡®ä¿ MetaMask è¿æ¥åˆ° Chain ID 31337 (Anvil)ã€‚

3. **ä½™é¢**: éƒ¨ç½²è„šæœ¬ä¼šè‡ªåŠ¨ä¸º deployer å’Œæµ‹è¯•è´¦æˆ·åˆ†é…ä»£å¸ã€‚

4. **é‡ç½®**: å¦‚æœé‡å¯ Anvilï¼Œéœ€è¦é‡æ–°éƒ¨ç½²åˆçº¦å¹¶æ›´æ–°å‰ç«¯é…ç½®ã€‚

## ğŸ› å¸¸è§é—®é¢˜

### äº¤æ˜“å¤±è´¥ / Nonce é”™è¯¯

é‡å¯ Anvil åï¼Œåœ¨ MetaMask ä¸­æ¸…é™¤äº¤æ˜“å†å²ï¼š
è®¾ç½® â†’ é«˜çº§ â†’ æ¸…é™¤æ´»åŠ¨å’Œ nonce æ•°æ®

### ä½™é¢ä¸æ›´æ–°

åˆ·æ–°é¡µé¢æˆ–æ‰‹åŠ¨é‡æ–°è¿æ¥é’±åŒ…ã€‚

### ç­¾åå¤±è´¥

ç¡®ä¿ä½ è¿æ¥çš„è´¦æˆ·æœ‰è¶³å¤Ÿçš„ ETH å’Œ ZZT ä»£å¸ã€‚

## ğŸ“„ License

MIT

## ğŸ™ è‡´è°¢

- RainbowKit Team
- Wagmi Contributors
- Viem Team
